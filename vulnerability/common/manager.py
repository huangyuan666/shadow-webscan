#encoding: utf-8

import logging

logger = logging.getLogger(__name__)

class Manager(object):
    PLUGINS = {}

    NIL = lambda *args, **kwargs: []

    @classmethod
    def check(cls, request):
        for name, plugin in cls.PLUGINS.items():
            logger.debug('plugin: %s check %s', name, request)
            check = getattr(plugin, 'check', cls.NIL)
            yield from check(request)

    @classmethod
    def clear(cls):
        for name, plugin in cls.PLUGINS.items():
            plugin.clear()


def register(name):
    def wrapper(cls):
        Manager.PLUGINS[name] = cls()
        return cls
    return wrapper

